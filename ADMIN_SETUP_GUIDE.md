# 관리자 화면 설정 가이드

## 1. 데이터베이스 설정

### 1.1 관리자 사용자 테이블 생성

Supabase 대시보드 > SQL Editor에서 다음 파일을 실행하세요:

1. `supabase-admin-users-schema.sql` - 관리자 사용자 테이블 생성
2. `supabase-announcements-admin-policies.sql` - 공지사항 관리자 정책 추가

### 1.2 첫 번째 관리자 추가

첫 번째 관리자를 추가하려면 Supabase 대시보드 > SQL Editor에서 다음 쿼리를 실행하세요:

```sql
-- 사용자 ID를 확인한 후 추가
-- 사용자 ID는 Supabase 대시보드 > Authentication > Users에서 확인 가능

INSERT INTO admin_users (user_id, notes)
VALUES ('사용자_UUID_여기', '초기 관리자');
```

또는 Supabase 대시보드 > Table Editor > `admin_users` 테이블에서 직접 추가할 수 있습니다.

## 2. 관리자 화면 기능

### 2.1 공지사항 관리

- **생성**: 새로운 공지사항 생성
- **수정**: 기존 공지사항 수정
- **삭제**: 공지사항 삭제
- **활성화/비활성화**: 공지사항 표시 여부 제어
- **우선순위 설정**: 공지사항 표시 순서 조정

### 2.2 사용자 통계

- **총 사용자 수**: 전체 사용자 수
- **활성 사용자 수**: 최근 30일 내 활동한 사용자 수
- **최근 가입자**: 최근 7일 내 가입한 사용자 수
- **최근 활동 사용자**: 최근 활동한 사용자 목록

### 2.3 데이터 통계

- **일기 통계**: 총 일기 작성 수
- **할 일 통계**: 총 할 일 수, 완료된 할 일 수, 완료율
- **5년 질문 통계**: 총 질문 수, 총 답변 수, 답변률
- **독서 통계**: 총 독서 기록 수, 총 읽은 페이지 수

## 3. 접근 방법

1. 관리자 권한이 있는 사용자로 로그인
2. 사이드바에서 "🔐 관리자" 메뉴 클릭
3. 관리자 대시보드에서 원하는 탭 선택

## 4. 관리자 추가/제거

### 4.1 관리자 추가

현재는 SQL을 통해 직접 추가해야 합니다:

```sql
INSERT INTO admin_users (user_id, notes)
VALUES ('사용자_UUID', '관리자 추가 이유');
```

### 4.2 관리자 제거

```sql
DELETE FROM admin_users
WHERE user_id = '사용자_UUID';
```

**주의**: 자기 자신은 제거할 수 없습니다.

## 5. 보안 고려사항

- 관리자 권한은 `admin_users` 테이블을 통해 관리됩니다
- RLS (Row Level Security) 정책으로 관리자만 관리 기능에 접근할 수 있습니다
- 관리자 화면은 관리자 권한이 있는 사용자만 볼 수 있습니다
- 네비게이션 메뉴의 관리자 메뉴는 관리자만 표시됩니다

## 6. 문제 해결

### 관리자 메뉴가 보이지 않는 경우

1. `admin_users` 테이블에 사용자 ID가 추가되어 있는지 확인
2. 로그아웃 후 다시 로그인
3. 브라우저 콘솔에서 오류 확인

### 관리자 화면에 접근할 수 없는 경우

1. 관리자 권한이 올바르게 설정되어 있는지 확인
2. RLS 정책이 올바르게 설정되어 있는지 확인
3. Supabase 대시보드에서 `admin_users` 테이블 확인
